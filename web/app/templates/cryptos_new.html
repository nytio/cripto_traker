{% extends "base.html" %}

{% block content %}
  <div class="card shadow-sm ct-form-card">
    <div class="card-body p-4">
      <div class="mb-4">
        <h1 class="h5 fw-semibold mb-1">Add crypto</h1>
        <p class="text-muted mb-0">Add a CoinGecko asset to your dashboard.</p>
      </div>
      <form method="post" action="{{ url_for('cryptos.create_crypto') }}" class="needs-validation" data-validate="1" novalidate>
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div class="form-floating mb-2">
          <input type="text" class="form-control" id="coingecko_id" name="coingecko_id" placeholder="bitcoin" pattern="[a-z0-9-]{2,50}" list="coingecko-list" required>
          <label for="coingecko_id">CoinGecko ID</label>
          <datalist id="coingecko-list">
            {% for crypto in existing_cryptos %}
              <option value="{{ crypto.coingecko_id }}">
                {{ crypto.name or crypto.coingecko_id }}{% if crypto.symbol %} ({{ crypto.symbol|upper }}){% endif %}
              </option>
            {% endfor %}
          </datalist>
          <div class="invalid-feedback">Enter a valid CoinGecko ID (2-50 lowercase characters).</div>
          <div class="valid-feedback">Looks good.</div>
        </div>
        <div class="text-muted small mb-3">
          Pick an existing crypto or enter a new CoinGecko ID. New IDs load 365 days of history automatically.
        </div>
        <div class="d-flex justify-content-end gap-2">
          <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('dashboard.index') }}">Cancel</a>
          <button type="submit" class="btn btn-sm btn-primary">Save</button>
        </div>
      </form>
    </div>
  </div>
{% endblock %}
